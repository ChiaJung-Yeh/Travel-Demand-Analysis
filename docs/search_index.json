[["multilevel-model.html", "Exercise 3 Multilevel Model 3.1 Constant-only Models 3.2 Fixed-effect only models 3.3 Add Random Effects", " Exercise 3 Multilevel Model PROBLEM You are provided with a travel survey data of Tainan (from “南臺區域運輸規劃”). Use trip distance as the outcome variable, and fit multilevel models with the grouping structure, respondents within districts. Fit two constant-only models, one using the original value of trip distance and the other transforming the value via logarithm. Explain the results, compare the two models, and pick one for the next step. Develop fixed-effect only (varying intercept) models; at least two respondent level and one district-level variables need to be included in the models. You need to find your own district-level variables. Explain your models, compared them, and pick one for the next step. 3.1 Constant-only Models The result of two constant-only models are shown in Table 3.1. The original value of trip distance is selected to be dependent variable in the first model (Model 1), while the second model (Model 2) takes the logarithm of trip distance. The trip distance is transformed to “kilometers” in advance, to avoid a huge coefficient in the result. The intercept of Model 1 is 5.328, which is the fixed effect of the constant term. The random effect for each district represents how much the intercept is shifted up or down in particular district. The random effect of each district is shown in the left panel of Figure 3.1. The red line implies that the estimates of trip distance is lower than the fixed effect, while the blue one is higher than that. Take 龍崎區 for instance, the random effect of it is 5.513 (check out by using ranef(), or the toppest point in Figure (fig:lm-dis). Since the total effect is composed of the fixed effect and the random effect, the final intercept would be \\(5.328+5.513=10.841\\). Note that if the line intersects with the “x=0” vertical line, it means that the estimate of trip distance for that district is not significantly inconsistent with the fixed effect, namely, the random effect might not be true. # Model 1 lm_dis=lmer(trip_dis ~ 1+(1|district), data=dat_southtw_tnan) # Model 2 lm_logdis=lmer(log_dis ~ 1+(1|district), data=dat_southtw_tnan) # print the model result tab_model(list(lm_dis, lm_logdis), show.aic=T) Table 3.1: Constant-only Models   Model 1 Model 2 Predictors Estimates CI p Estimates CI p (Intercept) 5.33 4.50 – 6.15 &lt;0.001 0.83 0.73 – 0.94 &lt;0.001 Random Effects σ2 34.45 1.62 τ00 5.65 district 0.08 district ICC 0.14 0.05 N 37 district 37 district Observations 3413 3413 Marginal R2 / Conditional R2 0.000 / 0.141 0.000 / 0.046 AIC 21859.757 11402.361 Figure 3.1: Random Effects of Intercept for each District The fixed intercept of Model 2 is 0.835, and the random effect is illustrated in the right panel of Figure (fig:lm-dis). We can find that when taking the logarithm form of trip distance, the sign of some random effects are not remained the same compared to the previous model. To choose a model, it is not correct to simply observe the value of AIC, BIC or log likelihood, since the dependent variable of two models are not the same. In terms of Intraclass Correlation Coefficient (ICC), it is the correlation between two observations within the same group. It is calculated as: \\[\\frac{\\tau_0}{\\tau_0+\\sigma^2}\\] , where \\(\\tau_0\\) is the between-group variation, while \\(\\sigma^2\\) is the within-group variation. It means the two variations are nearly the same when it approaches to 1, and it is no need to do multilevel regression. On the other hand, it indicates that the within-group Variation dominates when ICC approaches to 0. It is suggested to have ICC in range 0.05 to 0.25 for using multilevel model in the social science field. Under this background knowledge, ICC of Model 1 is 0.14, while 0.05 for Model 2, and thus, it is a better choice to keep going on Model 1. 3.2 Fixed-effect only models The district variable is retrieved from the database managed by Department of Budget, Accounting and Statistics of Tainan City Government. The socioeconomic variables include population density, sex ratio, aging index, natural increase, and so forth. To develop the random intercept multilevel model, Model 3 chooses population density as the district-level variable, and the respondent variables contain driver license (owns or not) as well as the number of personal car (categorized into three types: no car, one car, and no less than two cars). Also, Model 4 uses population growth as the district-level variable instead, and adding the gender as well as age to be the respondent levels. And then, Model 5 adds the trip purpose variable, while further add the mode class in Model 6. The model results are shown in Table 3.2. The coefficient and the confidence interval of each fixed effect variable is shown in Figure 3.2. # Model 3 lm_dis2=lmer(trip_dis ~ 1+license+pc_no+scale(pop_density)+(1|district), data=dat_southtw_tnan_new) # Model 4 lm_dis3=update(lm_dis2, .~. -scale(pop_density)+age+gender+pop_growth) # Model 5 lm_dis4=update(lm_dis2, .~. -scale(pop_density)+age+gender+pop_growth+trip_purp_rev) # Model 6 lm_dis5=update(lm_dis2, .~. -scale(pop_density)+age+gender+pop_growth+trip_purp_rev+mode_class) Table 3.2: Fixed-effect Only Models   Model 3 Model 4 Model 5 Model 6 (Intercept) 1.45** 2.62*** 2.35*** 1.29*   (0.51) (0.55) (0.55) (0.61) license 2.63*** 3.34*** 3.06*** 2.31***   (0.28) (0.30) (0.30) (0.35) pc_no1 1.11*** 1.02*** 1.01*** 0.64*   (0.26) (0.26) (0.26) (0.25) pc_no&gt;=2 2.37*** 2.27*** 2.23*** 1.08**   (0.38) (0.37) (0.37) (0.37) scale(pop_density) -0.98*         (0.42)       age   -0.04*** -0.03*** -0.03***     (0.01) (0.01) (0.01) gender女生   -1.11*** -0.96*** -0.74***     (0.20) (0.20) (0.19) pop_growth   -0.16*** -0.15*** -0.15***     (0.04) (0.04) (0.03) trip_purp_rev出差旅次     4.68*** 2.15       (1.21) (1.19) trip_purp_rev返家旅次     0.79*** 0.71**       (0.23) (0.23) trip_purp_rev個人事務與休閒旅次     -0.74* -0.31       (0.35) (0.34) trip_purp_rev購物旅次     -1.23*** -1.01***       (0.31) (0.30) mode_class自行車       0.64         (0.55) mode_class機車       1.75***         (0.42) mode_class汽車       5.57***         (0.48) AIC 21609.84 21532.35 21474.79 21270.24 BIC 21652.76 21587.54 21554.51 21368.36 Log Likelihood -10797.92 -10757.17 -10724.40 -10619.12 Num. obs. 3403 3403 3403 3403 Num. groups: district 37 37 37 37 Var: district (Intercept) 3.62 3.25 3.06 2.83 Var: Residual 32.67 31.80 31.24 29.39 ***p &lt; 0.001; **p &lt; 0.01; *p &lt; 0.05 Figure 3.2: Coefficients of Fixed Effect Variable For Model 3, we can find that respondents who have driver license would have 2.6 kilometers more on the trip distance. And the one who owns a personal car would have 1.1 kilometers more compared who have no cars. In terms of the coefficient of scale of population density, the negative (-0.979) value means that the trip distance would drop 0.979 kilometers as the population density increases by one standard deviation. It is because that the high population density area often owns a good accessibility to point interest, and people would travel less compared to the one living in a sparse area. Also, the intercept is 1.447, which is the fixed effect for all the district. For Model 4, population growth is replaced with the population density (note that it may not appropriate to place in the same model, for they have a high correlation). We can find that the trip distance would decrease approximately 0.16 kilometers as the growth increases by one percentage. Age variable suggests that the older respondents, the shorter travel distance. Last, female has a relatively lower trip distance than the male concluded by the model result. As for Model 5, the trip purpose is further added. Note that for easily developing the model, we classify all the purpose into 5 types, including shopping, commuting, home-trip, leisure, and business. The base of the dummy variable is commuting trip, we can find that the trip distance of home-trip and business trip are significantly higher, while the leisure and shopping trip is relatively lower. Last, Model 6 adds a most vital variable: mode classification. We can find that the trip distance of scooter and car are all significantly higher. Among all the 4 models mentioned above, AIC, BIC and log likelihood of Model 6 is apparently lowest. And it is mainly because the “mode” variable has been considered, and explains most of the variance. 3.3 Add Random Effects In addition to the varying intercept model, varying slope supposes that the coefficient of each variable is different among districts. Trying to add random effects as much as possible, the final result is shown in Model 11 in 3.3. This model contains the license, number of personal car, and the scale of population growth introduced in the previous model. And the random effect variable includes whether the respondent is elderly (&gt;65 years old), gender, and mode use in that trip. The diagnostics of the final model is shown in Figure 3.3. # Model 7 lm_dis_rnd1=lmer(log_dis ~ 1+license+pc_no+scale(pop_growth)+(1+aged|district), data=dat_southtw_tnan_new) # Model 8 lm_dis_rnd2=lmer(log_dis ~ 1+license+pc_no+scale(pop_growth)+(1+gender|district), data=dat_southtw_tnan_new) # Model 9 lm_dis_rnd3=lmer(log_dis ~ 1+license+pc_no+scale(pop_growth)+(1+aged+gender|district), data=dat_southtw_tnan_new) # Model 10 lm_dis_rnd4=lmer(log_dis ~ 1+license+pc_no+scale(pop_growth)+(1+mode_class|district), data=dat_southtw_tnan_new) # Model 11 lm_dis_rnd5=lmer(log_dis ~ 1+license+pc_no+scale(pop_growth)+(1+aged+gender+mode_class|district), data=dat_southtw_tnan_new) Table 3.3: Random-effect Models   Model 7 Model 8 Model 9 Model 10 Model 11 (Intercept) -0.36*** -0.13 -0.16* 0.48*** 0.61***   (0.09) (0.08) (0.08) (0.08) (0.08) license 0.95*** 0.96*** 0.94*** 0.45*** 0.47***   (0.06) (0.06) (0.06) (0.06) (0.06) pc_no1 0.24*** 0.28*** 0.24*** 0.16** 0.14**   (0.06) (0.06) (0.05) (0.05) (0.05) pc_no&gt;=2 0.49*** 0.51*** 0.48*** 0.22** 0.20**   (0.08) (0.08) (0.08) (0.07) (0.07) scale(pop_growth) -0.13** -0.06 -0.11** -0.08 -0.10**   (0.05) (0.04) (0.04) (0.04) (0.04) AIC 10964.87 11066.22 10941.76 10488.04 10385.51 BIC 11020.06 11121.41 11015.35 10586.16 10551.09 Log Likelihood -5473.43 -5524.11 -5458.88 -5228.02 -5165.76 Num. obs. 3403 3403 3403 3403 3403 Num. groups: district 37 37 37 37 37 Var: district (Intercept) 0.16 0.02 0.07 4.75 3.86 Var: district agedaged 0.49   0.47   0.30 Cov: district (Intercept) agedaged -0.20   -0.12   1.04 Var: Residual 1.41 1.47 1.39 1.19 1.14 Var: district gender女生   0.08 0.06   0.05 Cov: district (Intercept) gender女生   0.05 0.02   0.27 Cov: district agedaged gender女生     0.09   0.06 Var: district mode_class自行車       1.83 1.66 Var: district mode_class機車       4.06 3.44 Var: district mode_class汽車       7.59 6.62 Cov: district (Intercept) mode_class自行車       -2.93 -2.53 Cov: district (Intercept) mode_class機車       -4.34 -3.60 Cov: district (Intercept) mode_class汽車       -5.96 -5.00 Cov: district mode_class自行車 mode_class機車       2.71 2.39 Cov: district mode_class自行車 mode_class汽車       3.64 3.25 Cov: district mode_class機車 mode_class汽車       5.45 4.62 Cov: district agedaged mode_class自行車         -0.67 Cov: district agedaged mode_class機車         -0.95 Cov: district agedaged mode_class汽車         -1.40 Cov: district gender女生 mode_class自行車         -0.16 Cov: district gender女生 mode_class機車         -0.21 Cov: district gender女生 mode_class汽車         -0.33 ***p &lt; 0.001; **p &lt; 0.01; *p &lt; 0.05 Figure 3.3: Diagnostics of Model 11 From the diagnostics, we may conclude that the model performs not well enough, since the residuals are not very correspondent to the line in QQ plot, and the deviation is significant. In addition, the random effect of Model 11 is shown in 3.4. Figure 3.4: Diagnostics of Model 11 The random effect of mode is obvious, which has a huge difference between districts. It may because that how mode usage influences the trip distance are totally different among districts. In 西港區, 佳里區, 白河區, the random effect of mode class is higher, which may imply that the trip distance is much more affected by the choice of modal in these districts. For instance, trip distance would increase a lot when using car, compared to 白河區 and 南化區 (where the random effects of car use is 0). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
